(()=>{"use strict";let e,t;function i(i){const a=n(t),c=l(i,"axis").map((e=>r(e))),h=l(i,"legend").map((e=>d(e))),u=function(t){return e.items.filter((e=>"axis"===e.role&&e.items[0].items.some((e=>"axis-grid"===e.role)))).map((e=>t[e.items[0].orient]))}(c),m=o(c,h),p=s(),f=void 0!==l(i,"title")[0]?l(i,"title")[0].items[0].items[0].items[0].text:null;let g={data:p,axes:c,legends:h,description:a,gridNodes:u,dataFieldsUsed:m};return f&&(g.title=f),g}function s(){try{let i=new Map;const s=t.data?.map((e=>e.name));return s.map((t=>i.set(t,e.context.data[t].values.value))),i}catch(e){throw new Error(`No data defined in the Vega Spec \n ${e}`)}}function n(e){return e.description?e.description:"[Root]"}function r(e){const i=e.items[0],n=i.items.find((e=>"axis-tick"===e.role)).items.map((e=>e.datum.value)),r=i.items.find((e=>"axis-title"===e.role)),d=i.datum.scale;let o,l=t.scales?.find((e=>e.name===d))?.domain;o=void 0!==l.field?l.field:l.fields;const c="bottom"===i.orient||"top"===i.orient?"X-Axis":"Y-Axis",h=i.orient;return{values:n,title:void 0===r?c:`${c} titled '${r.items[0].text}'`,data:a(s(),d),field:o,scaleType:t.scales?.find((e=>e.name===d))?.type,orient:h}}function d(e){let i=e.items[0].datum.scales[Object.keys(e.items[0].datum.scales)[0]],n=a(s(),i);void 0===n&&(n=s().get("source_0"));let r,d=e.items[0].items.find((e=>"legend-entry"===e.role)).items[0].items[0].items,o=e.items[0].items.find((e=>"legend-title"===e.role)).items[0].text;const l=t.scales?.find((e=>e.name===i))?.domain;return l.field?r=l.field:Object.keys(n[0]).some((e=>e.toLocaleString()===o.toLocaleLowerCase()))&&(r=o.toLocaleLowerCase()),{values:d.map((e=>e.items.find((e=>"legend-label"===e.role)).items[0].datum.value)),title:o,data:n,field:r,scaleType:t.scales?.find((e=>e.name===i))?.type,type:""}}function a(e,i){const s=t.scales?.find((e=>i===e.name)).domain,n=s.data;return e.get(n)}function o(e,t){let i=[];const s=e=>{Object.keys(e).forEach((t=>{const s=e[t].field;"string"!=typeof s?s.forEach((e=>{i.push(e)})):i.push(s)}))};return s(e),s(t),i}function l(e,t){let i=[];const s=["cell","axis-grid"];return void 0===e.items||e.items.forEach((e=>{void 0!==e.role&&e.role===t&&c(e,s)?i.push(e):i=i.concat(l(e,t))})),i}function c(e,t){return void 0===e.role||t.some((t=>e.role.includes(t)))?void 0===e.role&&void 0!==e.items?e.items.every((e=>c(e,t))):void 0===e.role&&void 0===e.items:!(!e.items.every((e=>c(e,t)))&&void 0!==e.items)}function h(e,t){let i=b(e,"axis").map((i=>u(e,i,t))),s=b(e,"legend").map((i=>m(e,i,t))),n=i.concat(s).reduce(((e,t)=>e.concat(t.field)),[]),r=t.mark,d={axes:i.filter((e=>void 0!==e.field)),legends:s,description:"",dataFieldsUsed:n,gridNodes:[],data:g(e),markUsed:r};return p(d,t),function(e,t,i){switch(t){case"bar":const t=Object.keys(i.encoding).filter((e=>"nominal"===i.encoding[e].type||void 0===i.encoding[e].aggregate))[0];e.axes=e.axes.filter((e=>e.title.toLowerCase().includes(`${t}-axis`)));break;case"geoshape":break;case"point":e.title&&(e.title=`Scatter plot with title ${e.title} `),e.gridNodes=e.axes}}(d,r,t),d}function u(e,t,i){const s=t.items[0],n=s.orient,r="bottom"===n?"x":"y",d=s.items.find((e=>"axis-tick"===e.role)).items.map((e=>e.datum.value)),a=i.encoding[r].title,o=(s.datum.scale,f(g(e))),l="bottom"===s.orient||"top"===s.orient?"X-Axis":"Y-Axis";let c;return c=i.encoding[r].aggregate?Object.keys(o[0]).filter((e=>e.includes(i.encoding[r].field))):i.encoding[r].field,{values:d,title:void 0===a?l:`${l} titled '${a}'`,data:o,field:c,scaleType:i.encoding[r].type,orient:n,markUsed:i.mark}}function m(e,t,i){let s=t.items[0].datum.scales[Object.keys(t.items[0].datum.scales)[0]],n=f(g(e));return void 0===n&&(n=g(e).get("source_0")),{values:t.items[0].items.find((e=>"legend-entry"===e.role)).items[0].items[0].items.map((e=>e.items.find((e=>"legend-label"===e.role)).items[0].datum.value)),title:i.encoding.color.title?i.encoding.color.title:i.encoding.color.field,data:n,field:i.encoding.color.field,scaleType:i.scales?.find((e=>e.name===s))?.type,type:i.encoding.color.type,markUsed:i.mark}}function p(e,t){let i=t.description?t.description:"";void 0!==e.charts?(i=`${i} with ${e.charts.length} nested charts.`,e.description=t.description):e.description=`${i}`}function f(e,t,i){return e.get("source_0")}function g(e,t){try{let t=new Map;return Object.keys(e.context.data).forEach((i=>{t.set(i,e.context.data[i].values.value)})),t}catch(e){throw new Error(`No data defined in the Spec \n ${e}`)}}function b(e,t){let i=[];const s=["cell","axis-grid"];return void 0===e.items||e.items.forEach((e=>{void 0!==e.role&&e.role===t&&y(e,s)?i.push(e):i=i.concat(b(e,t))})),i}function y(e,t){return void 0===e.role||t.some((t=>e.role.includes(t)))?void 0===e.role&&void 0!==e.items?e.items.every((e=>y(e,t))):void 0===e.role&&void 0===e.items:!(!e.items.every((e=>y(e,t)))&&void 0!==e.items)}function x(e){const t=document.createElement("ul");return t.setAttribute("aria-labelledby","tree1"),t.setAttribute("id","treeView"),t.appendChild(function(e){let t=document.createElement("li");t.setAttribute("role","treeitem"),t.setAttribute("aria-expanded","false");const i=document.createElement("ul"),s=document.createElement("span");s.appendChild(document.createTextNode(e.description));const n=e.children,r=n.filter((e=>"data"===e.type));if(r.length>0){const t=document.createElement("table"),s=document.createElement("tbody"),n=document.createElement("tr");e.fieldsUsed.forEach((e=>{const t=document.createElement("th");t.setAttribute("class","tableInformation"),t.innerText=e,n.appendChild(t)})),s.appendChild(n),r.forEach((t=>{const i=document.createElement("tr");e.fieldsUsed.forEach((e=>{const s=document.createElement("td");s.setAttribute("class","tableInformation"),isNaN(t.selected[0][e])?s.innerText=t.selected[0][e]:s.innerText=Number(t.selected[0][e]).toFixed(2),i.appendChild(s)})),s.appendChild(i)})),t.appendChild(s),i.appendChild(t)}t.appendChild(s),n.length>0&&(n.filter((e=>"data"!==e.type)).forEach((e=>{i.appendChild(x(e))})),t.appendChild(i));const d=document.createElement("style");return d.innerHTML='ul[role="tree"] {\n    margin: 0;\n    padding: 0;\n    list-style: none;\n  }\n  \n  ul[role="tree"] li {\n    margin: 0;\n    padding: 0;\n    list-style: none;\n  }\n  \n  ul[role="tree"] a {\n    text-decoration: underline;\n    border-color: transparent;\n  }\n  \n  [role="treeitem"] ul {\n    margin: 0;\n    padding: 0;\n    margin-left: 0.9em;\n  }\n  \n  [role="treeitem"][aria-expanded="false"] > ul {\n    display: none;\n  }\n  \n  [role="treeitem"][aria-expanded="true"] > ul {\n    display: block;\n  }\n  \n  [role="treeitem"][aria-expanded="false"] > span::before {\n    position: relative;\n    left: -0.25em;\n  }\n  \n  [role="treeitem"][aria-expanded="true"] > span::before {\n    position: relative;\n    left: -0.25em;\n  }\n  \n  /* [role="treeitem"], */\n  [role="treeitem"] span {\n    width: 16em;\n    margin: 0;\n    padding: 0.125em;\n    border: 2px transparent solid;\n    display: block;\n  }\n  \n  /* disable default keyboard focus styling for treeitems\n     Keyboard focus is styled with the following CSS */\n  [role="treeitem"]:focus {\n    outline: 0;\n  }\n  \n  [role="treeitem"].focus,\n  [role="treeitem"] span.focus {\n    border-color: black;\n    background-color: #ddd;\n  }\n  \n  [role="treeitem"].hover,\n  [role="treeitem"] span.hover {\n    background-color: #ddd;\n  }',document.head.appendChild(d),t}(e)),t}class E{tree;level;parent;children;domNode;label;stopDefaultClick;isExpandable;isVisible;inGroup;lastVisitedChild;keyCode;constructor(e,t,i,s){if(e.tabIndex=-1,this.tree=t,this.parent=i,this.domNode=e,this.label=e.textContent.trim(),this.stopDefaultClick=!1,this.level=s,this.children=[],this.lastVisitedChild=null,"object"!=typeof e)return;e.getAttribute("aria-label")&&(this.label=e.getAttribute("aria-label").trim()),this.isExpandable=!1,this.isVisible=!1,this.inGroup=!1,i&&(this.inGroup=!0);let n=e.firstElementChild;for(;n;){if("ul"==n.tagName.toLowerCase()){n.setAttribute("role","group"),this.isExpandable=!0;break}n=n.nextElementSibling}this.keyCode=Object.freeze({RETURN:13,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,X:88,Y:89,L:76,G:71,W:87,A:65,S:83,D:68,ESCAPE:27,PLUS:107,MINUS:189})}init(){this.domNode.tabIndex=-1,this.domNode.getAttribute("role")||this.domNode.setAttribute("role","treeitem"),this.domNode.addEventListener("keydown",this.handleKeydown.bind(this)),this.domNode.addEventListener("click",this.handleClick.bind(this)),this.domNode.addEventListener("focus",this.handleFocus.bind(this)),this.domNode.addEventListener("blur",this.handleBlur.bind(this)),this.isExpandable?(this.domNode.firstElementChild.addEventListener("mouseover",this.handleMouseOver.bind(this)),this.domNode.firstElementChild.addEventListener("mouseout",this.handleMouseOut.bind(this))):(this.domNode.addEventListener("mouseover",this.handleMouseOver.bind(this)),this.domNode.addEventListener("mouseout",this.handleMouseOut.bind(this)))}isExpanded(){return!!this.isExpandable&&"true"===this.domNode.getAttribute("aria-expanded")}handleKeydown(e){this.stopDefaultClick=!1,e.altKey||e.ctrlKey||e.metaKey||(e.shift?e.keyCode!=this.keyCode.SPACE&&e.keyCode!=this.keyCode.RETURN||(e.stopPropagation(),this.stopDefaultClick=!0):this.checkBaseKeys(e))}checkBaseKeys(e){let t=!1;switch(e.keyCode){case this.keyCode.SPACE:case this.keyCode.RETURN:this.isExpandable?(this.isExpanded()?this.tree.collapseTreeitem():this.tree.expandTreeitem(this),t=!0):(e.stopPropagation(),this.stopDefaultClick=!0);break;case this.keyCode.DOWN:this.children.length>0&&(this.isExpandable&&this.tree.expandTreeitem(this),this.tree.setFocusToNextLaver()),t=!0;break;case this.keyCode.LEFT:this.tree.setFocusToPreviousItem(),t=!0;break;case this.keyCode.RIGHT:this.tree.setFocusToNextItem(),t=!0;break;case this.keyCode.ESCAPE:case this.keyCode.UP:this.isExpandable&&this.isExpanded()?(this.tree.setFocusToParentItem(),this.tree.collapseTreeitem(),t=!0):this.inGroup&&(this.tree.setFocusToParentItem(),t=!0);break;case this.keyCode.HOME:this.tree.setFocusToItem(this.parent.children[0]),t=!0;break;case this.keyCode.END:this.tree.setFocusToItem(this.parent.children[this.parent.children.length-1]),t=!0;break;case this.keyCode.X:this.tree.focusOnSpecificNode("x-axis",this);break;case this.keyCode.Y:this.tree.focusOnSpecificNode("y-axis",this);break;case this.keyCode.L:this.tree.focusOnSpecificNode("legend",this)}t&&(e.stopPropagation(),e.preventDefault())}handleClick(e){e.target!==this.domNode&&e.target!==this.domNode.firstElementChild||this.isExpandable&&(this.isExpanded()?(this.tree.setFocusToItem(this),this.tree.collapseTreeitem()):(this.isExpandable&&!this.isExpanded()&&(this.tree.expandTreeitem(this),this.tree.setFocusToItem(this)),this.tree.setFocusToNextLaver()),e.stopPropagation())}handleFocus(e){let t=this.domNode;this.isExpandable&&(t=t.firstElementChild),t.classList.add("focus")}handleBlur(e){let t=this.domNode;this.isExpandable&&(t=t.firstElementChild),t.classList.remove("focus")}handleMouseOver(e){e.currentTarget.classList.add("hover")}handleMouseOut(e){e.currentTarget.classList.remove("hover")}}class N extends E{gridIndex;gridWidth;rowPosition;constructor(e,t,i,s){super(e,t,i,s),this.gridIndex=this.parent.children.length,this.gridWidth=(e=>this.parent.parent.children.reduce(((e,t)=>t.label.includes("X-Axis")?t:e)))().children.length,this.rowPosition=(()=>{if(0!==this.gridIndex){let e=this.parent.children[this.gridIndex-1].rowPosition;return e<=this.gridWidth?e+1:1}return 1})()}handleKeydown(e){super.handleKeydown(e);let t=this.parent.children.indexOf(this);switch(e.keyCode){case this.keyCode.W:t+this.gridWidth<=this.parent.children.length&&this.tree.setFocusToItem(this.parent.children[t+this.gridWidth]);break;case this.keyCode.S:t-this.gridWidth>=0&&this.tree.setFocusToItem(this.parent.children[t-this.gridWidth]);break;case this.keyCode.A:this.rowPosition>1&&this.tree.setFocusToItem(this.parent.children[t-1]);break;case this.keyCode.D:this.rowPosition<this.gridWidth&&this.tree.setFocusToItem(this.parent.children[t+1])}}}class v{domNode;treeitems;firstTreeitem;lastTreeitem;currentNode;constructor(e){"object"==typeof e&&(this.domNode=e,this.treeitems=[])}init(){this.domNode.getAttribute("role")||this.domNode.setAttribute("role","tree"),function e(t,i,s,n){let r=t.firstElementChild,d=s;for(;r;)("li"===r.tagName.toLowerCase()&&"span"===r.firstElementChild.tagName.toLowerCase()||"tr"===r.tagName.toLowerCase()||"th"===r.tagName.toLowerCase()||"td"===r.tagName.toLowerCase())&&(d=s&&"Grid view"===s.label.substring(0,9)?new N(r,i,s,n):new E(r,i,s,n),d.init(),s&&s.children.push(d),i.treeitems.push(d)),r.firstElementChild&&e(r,i,d,n+1),r=r.nextElementSibling}(this.domNode,this,void 0,0),this.updateVisibleTreeitems(),this.firstTreeitem.domNode.tabIndex=0,this.currentNode=this.firstTreeitem}setFocusToItem(e){this.currentNode=e,this.currentNode.domNode.tabIndex=0,this.currentNode.domNode.focus()}setFocusToNextItem(){if(this.currentNode.parent){let e=this.currentNode.parent.children.indexOf(this.currentNode);e<this.currentNode.parent.children.length-1&&this.setFocusToItem(this.currentNode.parent.children[e+1])}}setFocusToNextLaver(){null!==this.currentNode.lastVisitedChild?this.setFocusToItem(this.currentNode.lastVisitedChild):this.setFocusToItem(this.currentNode.children[0])}setFocusToPreviousItem(){if(this.currentNode.parent){let e=this.currentNode.parent.children.indexOf(this.currentNode);e>0&&this.setFocusToItem(this.currentNode.parent.children[e-1])}}setFocusToParentItem(){this.currentNode.parent&&(this.currentNode.parent.lastVisitedChild=this.currentNode,this.setFocusToItem(this.currentNode.parent),this.currentNode.isExpandable&&this.currentNode.isExpanded&&this.collapseTreeitem())}setFocusToFirstItem(){this.setFocusToItem(this.firstTreeitem)}setFocusToLastItem(){this.setFocusToItem(this.lastTreeitem)}expandTreeitem(e){e.isExpandable&&(e.domNode.setAttribute("aria-expanded",!0),this.updateVisibleTreeitems())}expandAllSiblingItems(e){for(let t=0;t<this.treeitems.length;t++){let i=this.treeitems[t];i.parent===e.parent&&i.isExpandable&&this.expandTreeitem(i)}}collapseTreeitem(){let e;e=this.currentNode.isExpanded()?this.currentNode:this.currentNode.parent,e&&(e.domNode.setAttribute("aria-expanded",!1),this.updateVisibleTreeitems(),this.setFocusToItem(e))}updateVisibleTreeitems(){this.firstTreeitem=this.treeitems[0];for(let e=0;e<this.treeitems.length;e++){let t=this.treeitems[e],i=t.domNode.parentNode;for(t.isVisible=!0;i&&i!==this.domNode;)"false"==i.getAttribute("aria-expanded")&&(t.isVisible=!1),i=i.parentNode;t.isVisible&&(this.lastTreeitem=t)}}focusOnSpecificNode(e,t,i){let s=i||[];if(!s.includes(t))if(s.push(t),t.label.split(" ")[0].toLowerCase()===e){const e=t=>{t&&(t.isExpanded()||(this.expandTreeitem(t),e(t.parent)))},i=e=>{t!==e&&(e.parent.lastVisitedChild=e,this.currentNode=e.parent,this.collapseTreeitem())};e(t.parent),t.isExpanded()&&(i(this.currentNode),t.lastVisitedChild=this.currentNode,this.collapseTreeitem()),this.setFocusToItem(t)}else t.parent&&this.focusOnSpecificNode(e,t.parent,s),t.children.forEach((t=>this.focusOnSpecificNode(e,t,s)))}}function C(e){let t;if(void 0!==e.charts)t=A(e.description,null,e.data.get("source_0"),"multiView",e),t.description+=` With ${t.children.length} nested charts`;else{const i=e.axes.length>0?` ${e.axes.length} axes and`:"",s=e.legends.length>0?` ${e.legends.length} legends`:"";t=A(e.description,null,[],"chart",e),t.description+=` with ${i} ${s}`}return t.children.forEach((t=>L(t,e))),t}function T(e,t,i,s,n){if(i.length>0){const r=i.pop(),d=r.scaleType?`for a ${r.scaleType} scale `:"",a=Array.isArray(r.field)?r.field[1]:r.field;let o=r.data.reduce(((e,t)=>t[a]<e?t[a]:e),r.data[0][a]),l=r.data.reduce(((e,t)=>t[a]>e?t[a]:e),r.data[0][a]);a.toLowerCase().includes("date")&&(o=new Date(o).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"}),l=new Date(l).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"}));const c=`${r.title} ${d}with values from ${o} to ${l}`;return e.push(A(c,t,r.data,r.title.includes("Y-Axis")?"yAxis":"xAxis",r)),T(e,t,i,s,n)}if(s.length>0){const r=s.pop(),d=r.scaleType?`for ${r.scaleType} scale `:"";let a=A(r.title,t,r.data,"legend",r);return a.description=`Legend titled '${a.description}' ${d}with ${a.children.length} values`,e.push(a),T(e,t,i,s,n)}if(n.length>0&&2===n.length){const r=[n.pop(),n.pop()];return e.push(A("Grid view of the data",t,r[0].data,"grid",r)),T(e,t,i,s,n)}return e}function k(e,t,i,s){let n,r=i-1;if(-1===r&&0!==t)n=[t-(s[i+1]-t),t];else if(i===s.length-1){const e=t-s[i-1];let r;r=t instanceof Date?t.getTime()+e:t+e,n=[t,r]}else n=[s[r],s[r+1]];return e.push([n[0],n[1]]),e}function w(e,t,i){if(t.length>0){const s=t.pop();let n={};Object.keys(s).forEach((e=>{e.toLowerCase().includes("date")?n[e]=new Date(s[e]).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"}):n[e]=s[e]})),e.push(A(F(s),i,[n],"data")),w(e,t,i)}return e}function O(e,t,i){if("multiView"===e)return function(e,t){return t.charts.map((i=>A(`A facet titled ${i.facetedValue}, ${t.charts.indexOf(i)+1} of ${t.charts.length}`,e,[],"chart",i)))}(t,i);if("chart"===e){let e="point"===i.markUsed?i.gridNodes:[];return t.parent&&(i.axes.forEach((e=>{e.data=e.data.filter((e=>Object.keys(e).some((t=>e[t]===i.facetedValue))))})),i.legends.forEach((e=>{e.data=e.data.filter((e=>Object.keys(e).some((t=>e[t]===i.facetedValue))))}))),T([],t,i.axes,i.legends,e)}return"xAxis"===e||"yAxis"===e||"legend"===e?function(e,t,i,s,n){if(function(e){return e.every((e=>"string"==typeof e))}(i)||"legend"===e.type)return i.map((i=>A(`${[[i]]}`,e,s.filter((e=>e[t]===i)),"filteredData",s.filter((e=>e[t]===i)))));{const r=(e,i)=>s.filter((s=>s[t]>=e&&s[t]<i));let d;return d="bar"!==n?i.reduce(k,[]):i.map((e=>[e,e])),d.map((t=>{let i="";return e.description.includes("date")||e.description.includes("temporal")?t.forEach((e=>i+=`${new Date(e).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"})}, `)):i=`${t},`,A(i,e,r(t[0],t[1]),"filteredData",r(t[0],t[1]))}))}}(t,i.field,i.values,i.data,i.markUsed):"filteredData"===e?w([],i.map((e=>Object.assign({},e))),t):"grid"===e?function(e,t,i,s,n){let r=[];const d=i.reduce(k,[]),a=s.reduce(k,[]);return d.forEach((i=>{a.forEach((s=>{const d=(a=s[0],o=s[1],l=i[0],c=i[1],n.filter((e=>e[t[1]]>=a&&e[t[1]]<o&&e[t[0]]>=l&&e[t[0]]<c)));var a,o,l,c;r.push(A(`${[i,s]}`,e,d,"filteredData",d))}))})),r}(t,[i[0].field,i[1].field],i[0].values,i[1].values,i[0].data):[]}function A(e,t,i,s,n){let r={description:e,parent:t,children:[],selected:i,type:s,fieldsUsed:null!==t?t.fieldsUsed:n.dataFieldsUsed};return n&&(r.children=O(s,r,n)),r.description=F(r),r}function F(e){return"multiView"===e.type||"chart"===e.type||"xAxis"===e.type||"yAxis"===e.type||"legend"===e.type?e.description:"filteredData"===e.type?`Range ${e.description} ${e.selected.length} values in the interval`:"grid"===e.type?e.description:"data"===e.type?e.fieldsUsed.reduce(((t,i)=>`${t} ${i}: ${e.selected[0][i]}`),""):""}function L(e,t){"filteredData"===e.type&&"line"===t.markUsed&&(e.description=`${e.description}.`),e.children.forEach((e=>L(e,t)))}window.createAccessibilityTree=function(a){let c;switch(a.adapter){case"vega":f=a.visObject.scenegraph().root.items[0],y=a.visSpec,e=f,t=y,c=e.items.some((e=>"scope"===e.role))?function(){const a=e=>{let t=[];return e.forEach((e=>{t.every((t=>JSON.stringify(t)!==JSON.stringify(e)))&&t.push(e)})),t},c=n(t),h=a(l(e,"axis").map((e=>r(e)))),u=a(l(e,"legend").map((e=>d(e))));let m={charts:e.items.filter((e=>"scope"===e.role))[0].items.map((e=>{let t=i(e);return t.title=l(e,"title-text")[0].items[0].text,t})),data:s(),dataFieldsUsed:o(h,u),description:c,facetedField:""};const p=(e,t)=>{e.forEach((e=>{const i=Object.assign({},e);i.data=JSON.parse(JSON.stringify(e.data)),t.push(i)}))};return m.charts.forEach((e=>{p(h,e.axes),p(u,e.legends)})),m}():i(e);break;case"vega-lite":c=((e,t)=>e.items.some((e=>"scope"===e.role))?function(e,t){const i=e=>{let t=[];return e.forEach((e=>{t.every((t=>JSON.stringify(t)!==JSON.stringify(e)))&&t.push(e)})),t};let s=i(b(e,"axis").map((i=>u(e,i,t)))),n=i(b(e,"legend").map((i=>m(e,i,t)))),r=s.concat(n).reduce(((e,t)=>e.concat(t.field)),[]),d=void 0!==t.encoding.facet?t.encoding.facet.field:t.encoding.color.field,a=e.items.filter((e=>"scope"===e.role))[0].items.map((e=>{let i=h(e,t);return b(e,"title-text")[0],i.facetedValue=e.datum[d],i}));const o=(e,t)=>{e.forEach((e=>{const i=Object.assign({},e);i.data=JSON.parse(JSON.stringify(e.data)),t.push(i)}))};a.forEach((e=>{o(s,e.axes),o(n,e.legends)}));let l={description:"",data:g(e),dataFieldsUsed:r,charts:a,facetedField:d};return l.dataFieldsUsed.push(d),l.charts.forEach((e=>{for(let t in e.data.keys()){let i=e.data.get(t);e.data.set(t,i.filter((t=>t[d]===e.title)))}})),p(l,t),l}(e,t):h(e,t))(a.visObject.scenegraph().root.items[0],a.visSpec)}var f,y;let E,N=C(c);switch(a.renderType){case"table":E=function(e){const t=document.createElement("table"),i=document.createElement("tbody"),s=document.createElement("tr");return e.fieldsUsed.forEach((e=>{const t=document.createElement("th");t.innerText=e,s.appendChild(t)})),i.appendChild(s),e.selected.forEach((t=>{const s=document.createElement("tr");e.fieldsUsed.forEach((e=>{const i=document.createElement("td");i.innerText=t[e],s.appendChild(i)})),i.appendChild(s)})),t.appendChild(i),t}(N);break;case"tree":E=x(N),new v(E).init()}a.ariaLabel&&E.setAttribute("aria-label",a.ariaLabel),document.getElementById(a.domId)?.appendChild(E)}})();